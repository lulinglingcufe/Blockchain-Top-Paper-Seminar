
大家好，今天和大家分享一下中本聪的比特币原文。

一种点对点的电子现金系统。主要的motivation是什么呢？

传统的支付系统是中心化的，中间的银行要收手续费，跨境转账还需要长确认时间。

我们知道利用数字签名可以方便地验证消息的真实性。

双花问题是指一笔钱，花了两次。

为了解决最基本的双花问题，保证交易的一致性，btc采用了pow共识，使用分布式账本记录交易。

我们先来看一下btc里面如何定义价值

btc采用的是utxo模型，Unspent transaction output未花费的交易输出。

所有的btc最初来源于矿工挖出一个区块的奖励。矿工可以在自己挖出的区块的最后一笔交易写入：给一个地址50btc的奖励。
这个奖励是每4年减半，因此BTC总量2100万。

每个交易可以包括多个输入和输出，输入就是钱从哪个地址来，输出就是钱要到哪个地址去。
这个20btc的交易有两笔输入，分成了三个输出。一个未花费过的输出，可以作为下一笔交易的输入。

然后我们来看如何用密码学的方法，验证交易的有效性。

付款人地址和金额是输入，收款人地址和金额是输出。

付款人找到自己一个未花费过的输出，对这笔交易和当前的转账交易进行签名
当前的交易需要确定转账给谁：也就是说，这笔交易的输出地址和金额是多少。

我们来考虑双重支付的问题。我们要让收款人知道：付款人没有对未花费输出有更早的签名。

我们要让收款人知道：付款人没有对未花费输出有更早的签名。

在没有第三方的情况下，交易必须被全网广播。一个系统里面所有参与者只对在一个单链的历史顺序达成共识。收款人需要确保，当一笔交易出现时，这笔交易是大多数节点公认第一次出现的。

Bitcoin的原文里，把记录交易的区块链系统定义为一个时间戳服务器。

具体来说呢，他对一个由数据组成的区块的哈希值打上时间戳。然后再广播这个hash值，就像把它登报或者在新闻组网络进行传播一样。

每一个时间戳在hash过程中都包含前面一个区块的时间戳。这样构成一个链条。

这样做的目的是实现交易的可追溯性。

接着我们来看pow的共识机制。

为了确定谁能增加一个新区块，我们需要采用一种工作量证明机制，类似Adam Back的hash现金。

矿工需要在区块中放入一个随机数(Nonce)，这个随机数要使得这个区块的hash值出现了所需的那么多个0。

矿工需要通过反复计算来找到这个随机数，找这个随机数的过程就是在做工作，谁做的工作越多，谁找到这个随机数的概率就越大，这样就构建了一个工作量证明机制。

矿工地址说明了区块是该矿工挖出来的，如果修改区块内容必须重新做一遍相当的工作量。

如果修改区块必须重新做一遍相当的工作量。

pow最早的发明是为了解决互联网信息垃圾问题。

全网算力变化，为了保证比特币的平均出块时间稳定在十分钟，需要定期调整随机数计算难度。

区块链存在分叉的可能：就是说同时有两个矿工挖出了正确的区块。矿工选择要在哪个区块之后继续挖矿。最长链将被保留。

我们来看一下btc网络具体是如何运行的。

首先客户端的转账交易被广播给矿工节点。然后矿工节点收集交易，形成区块。

矿工节点进行挖矿（hash计算），通过pow共识竞争区块记账权。

挖矿成功的矿工广播区块给所有节点，表示自己是第一个算出最新区块随机数的节点

其他节点验证区块的有效性，然后在这个区块之后继续竞争下一个区块的记账权。

那么节点为什么要参与到区块链网络中呢？第一，挖矿成功能够获得btc奖励；其次交易要付手续费给矿工。

中本聪的论文中，着重提出了几个技术。基于交易列表形成Merkel Tree；然后将Merkel Tree的root放在区块头里，从而减少存储空间。具体来说，一个区块的大小在1兆左右，而区块头只需要80字节。

第二个技术是SPV，简化的交易验证。如何验证交易的有效性？节点需要查询其他节点，获得最长链。
比如要验证t3交易。只需要获得hash01与hash02，而非所有交易hash。这个技术我之前讲的李飞飞提出的MB-tree的原理也是如此。

btc交易的隐私性非常强。因为交易只需要用到公私钥，和用户的真实身份是无法绑定的。

那么一笔交易要花多久确认呢？btc里面是6个区块，大概1小时。足够长的区块链接到该交易出现的区块后面，那么可以认为这个交易已经被记录到最长链上了。

中本聪的论文里分析了：攻击者对区块链进行分叉的可能性。

假设攻击者比诚实链落后了z个区块，P是攻击者的链超过诚实链的可能性，q是攻击者拥有的全网算力。

在q是10%的情况下，落后的区块越多，攻击成功的可能性越小。事实也证明btc的pow共识十分有效，btc系统已经在分布式的情况下，运行了十多年。

最后我们来看一下btc交易的生命周期。bob要发送0.3个btc给laura。首先bob复制laura的地址。填写转账金额。bob使用具有未花费比特币地址的账户私钥对这笔交易进行签名，然后广播给矿工节点。矿工节点将交易放到区块里，并进行挖矿。

解决随机数难题的矿工挖矿成功，获得btc奖励，将区块广播给其他验证节点。最后laura确认交易的有效性。
